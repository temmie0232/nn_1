# 未知データ予測ガイド

このドキュメントは、訓練済みモデル (`model.pth`) を使用して未知の画像データを予測するための手順と必要条件を説明します。

## 目的

`predict.py`スクリプトは、事前に学習されたモデル (`model.pth`) をロードし、ユーザーが指定した画像ファイルのクラスを予測するために使用されます。

## 前提条件

予測プログラムを実行する前に、以下の条件が満たされていることを確認してください。

1.  **Python環境**: Python 3.x がインストールされていること。
2.  **必要なライブラリ**: `train.py`の実行に必要なライブラリ（`torch`, `torchvision`, `Pillow`, `tqdm`, `numpy`, `scikit-learn`）がインストールされていること。
    *   `pip install torch torchvision pillow tqdm numpy scikit-learn`
    *   GPUを使用する場合は、PyTorchのCUDA対応版をインストールしてください。
3.  **訓練済みモデルファイル**: `model.pth`ファイルが`predict.py`と同じディレクトリに存在すること。
    *   このファイルは、`train.py`スクリプトの実行によって生成されます。
4.  **データセット構造**: `dataset`ディレクトリが、訓練時と同じ階層構造で存在すること。
    *   `predict.py`は、クラス名とインデックスのマッピング (`class_to_idx`) を取得するために、`dataset.py`の `load_all_data` 関数を使用します。この関数は、`../dataset`パスを基準にデータセットを探索します。

## 使用方法

1.  **ターミナルを開く**: `predict.py`ファイルが保存されているディレクトリ (`/home/temmie0232/lecture/u/lab/nn_1/src/`) に移動します。

2.  **プログラムの実行**: 以下のコマンドを実行します。
    ```bash
    python3 predict.py
    ```

3.  **画像パスの入力**: プログラムが起動すると、「予測したい画像ファイルのパスを入力してください (終了するには 'q' を入力): 」というプロンプトが表示されます。
    *   予測したい画像ファイルの**絶対パス**、または`predict.py`からの**相対パス**を入力し、Enterキーを押します。
    *   例:
        *   `/path/to/your/image.jpg` (絶対パス)
        *   `../test_images/sample.png` (相対パス)

4.  **予測結果の表示**: 入力された画像が正常に処理されると、モデルによる予測結果が表示されます。

5.  **プログラムの終了**: 予測を終了するには、プロンプトで `q` または `Q` を入力し、Enterキーを押します。

## 注意点

*   **GPUの利用**: システムにCUDA対応GPUが搭載されており、PyTorchが適切にインストールされていれば、自動的にGPUが使用されます。
*   **画像形式**: `Pillow`ライブラリがサポートする一般的な画像形式（JPEG, PNGなど）が使用可能です。
*   **エラーハンドリング**: 指定された画像ファイルが見つからない場合、エラーメッセージが表示されます。
